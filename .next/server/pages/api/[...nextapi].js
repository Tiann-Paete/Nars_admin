"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/[...nextapi]";
exports.ids = ["pages/api/[...nextapi]"];
exports.modules = {

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "mysql2/promise":
/*!*********************************!*\
  !*** external "mysql2/promise" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("mysql2/promise");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2F%5B...nextapi%5D&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5C%5B...nextapi%5D.js&middlewareConfigBase64=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2F%5B...nextapi%5D&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5C%5B...nextapi%5D.js&middlewareConfigBase64=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_nextapi_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src\\pages\\api\\[...nextapi].js */ \"(api)/./src/pages/api/[...nextapi].js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_nextapi_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_nextapi_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/[...nextapi]\",\n        pathname: \"/api/[...nextapi]\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _src_pages_api_nextapi_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRiU1Qi4uLm5leHRhcGklNUQmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZzcmMlNUNwYWdlcyU1Q2FwaSU1QyU1Qi4uLm5leHRhcGklNUQuanMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ0w7QUFDMUQ7QUFDK0Q7QUFDL0Q7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLHNEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyxzREFBUTtBQUNwQztBQUNPLHdCQUF3QixnSEFBbUI7QUFDbEQ7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hZG1pbnBhbmVsLz82YWUxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9zcmNcXFxccGFnZXNcXFxcYXBpXFxcXFsuLi5uZXh0YXBpXS5qc1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL1suLi5uZXh0YXBpXVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL1suLi5uZXh0YXBpXVwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2F%5B...nextapi%5D&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5C%5B...nextapi%5D.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./src/pages/api/[...nextapi].js":
/*!***************************************!*\
  !*** ./src/pages/api/[...nextapi].js ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler),\n/* harmony export */   handleUpdateAdminData: () => (/* binding */ handleUpdateAdminData)\n/* harmony export */ });\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mysql2/promise */ \"mysql2/promise\");\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mysql2_promise__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var url__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! url */ \"url\");\n/* harmony import */ var url__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(url__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _utils_db__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/db */ \"(api)/./src/utils/db.js\");\n\n\n\n\nconst db = mysql2_promise__WEBPACK_IMPORTED_MODULE_0___default().createPool({\n    host: process.env.MYSQL_HOST,\n    port: process.env.MYSQL_PORT,\n    user: process.env.MYSQL_USER,\n    password: process.env.MYSQL_PASSWORD,\n    database: process.env.MYSQL_DATABASE,\n    waitForConnections: true,\n    connectionLimit: 10,\n    queueLimit: 0\n});\nasync function handler(req, res) {\n    const { method } = req;\n    const { pathname, query } = (0,url__WEBPACK_IMPORTED_MODULE_1__.parse)(req.url, true);\n    console.log(\"Received request:\", method, pathname, query);\n    if (pathname === \"/api/test\") {\n        res.status(200).json({\n            message: \"Test route working\"\n        });\n        return;\n    }\n    if (pathname === \"/api/admin-name\") {\n        try {\n            const [results] = await db.query(\"SELECT full_name FROM admin LIMIT 1\");\n            if (results.length > 0) {\n                res.status(200).json({\n                    fullName: results[0].full_name\n                });\n            } else {\n                res.status(404).json({\n                    error: \"Admin not found\"\n                });\n            }\n        } catch (error) {\n            console.error(\"Error fetching admin name:\", error);\n            res.status(500).json({\n                error: \"An error occurred while fetching admin name\"\n            });\n        }\n        return;\n    }\n    try {\n        switch(method){\n            case \"GET\":\n                if (pathname === \"/api/check-auth\") {\n                    const authHeader = req.headers.authorization;\n                    if (!authHeader) {\n                        return res.status(200).json({\n                            isAuthenticated: false,\n                            usernamePasswordVerified: false\n                        });\n                    }\n                    const token = authHeader.split(\" \")[1];\n                    try {\n                        const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, process.env.JWT_SECRET);\n                        const now = Math.floor(Date.now() / 1000);\n                        if (decoded.exp && decoded.exp > now) {\n                            // Token is still valid\n                            return res.status(200).json({\n                                isAuthenticated: true,\n                                usernamePasswordVerified: true,\n                                expiresIn: decoded.exp - now\n                            });\n                        } else {\n                            // Token has expired\n                            return res.status(200).json({\n                                isAuthenticated: false,\n                                usernamePasswordVerified: false\n                            });\n                        }\n                    } catch (error) {\n                        return res.status(200).json({\n                            isAuthenticated: false,\n                            usernamePasswordVerified: false\n                        });\n                    }\n                } else if (pathname === \"/api/products\") {\n                    await handleGetProducts(req, res);\n                } else if (pathname === \"/api/total-stock\") {\n                    await handleGetTotalStock(req, res);\n                } else if (pathname === \"/api/sales-report\") {\n                    await handleGetSalesReport(req, res);\n                } else if (pathname === \"/api/sales-data\") {\n                    await handleGetSalesData(req, res);\n                } else if (pathname === \"/api/total-products\") {\n                    await handleGetTotalProducts(req, res);\n                } else if (pathname === \"/api/top-products\") {\n                    await handleGetTopProducts(req, res);\n                } else if (pathname === \"/api/rated-products-count\") {\n                    await handleGetRatedProductsCount(req, res);\n                } else if (pathname === \"/api/logout\") {\n                    await handleLogout(req, res);\n                    return;\n                } else if (pathname === \"/api/orders\") {\n                    await handleGetOrders(req, res);\n                } else if (pathname === \"/api/admin-data\") {\n                    await handleGetAdminData(req, res);\n                } else if (pathname === \"/api/session-history\") {\n                    await handleGetSessionHistory(req, res);\n                }\n                break;\n            case \"POST\":\n                if (pathname === \"/api/signin\") {\n                    await handleSignIn(req, res);\n                } else if (pathname === \"/api/validate-pin\") {\n                    await handleValidatePin(req, res);\n                } else if (pathname === \"/api/products\") {\n                    await handleAddProduct(req, res);\n                }\n                break;\n            case \"PUT\":\n                if (pathname.startsWith(\"/api/products/\")) {\n                    const id = pathname.split(\"/\").pop();\n                    await handleUpdateProduct(req, res, id);\n                } else if (pathname.startsWith(\"/api/orders/\")) {\n                    const parts = pathname.split(\"/\");\n                    const id = parts[3]; // This is the order ID\n                    if (parts[4] === \"status\") {\n                        await handleUpdateOrderStatus(req, res, id);\n                    } else if (parts[4] === \"cancel\") {\n                        await handleCancelOrder(req, res, id);\n                    } else {\n                        await handleUpdateOrder(req, res, id);\n                    }\n                }\n                if (pathname === \"/api/update-admin\") {\n                    await handleUpdateAdminData(req, res);\n                }\n                break;\n            case \"DELETE\":\n                if (pathname.startsWith(\"/api/products/\")) {\n                    const id = pathname.split(\"/\").pop();\n                    await handleDeleteProduct(req, res, id);\n                } else if (pathname.startsWith(\"/api/orders/\") && pathname.endsWith(\"/salesreport\")) {\n                    await handleRemoveOrderFromSalesReport(req, res);\n                } else {\n                    res.status(404).json({\n                        error: \"Route not found\"\n                    });\n                }\n                break;\n            default:\n                res.setHeader(\"Allow\", [\n                    \"GET\",\n                    \"POST\",\n                    \"PUT\",\n                    \"DELETE\"\n                ]);\n                res.status(405).end(`Method ${method} Not Allowed`);\n        }\n        res.status(404).json({\n            error: \"Route not found\"\n        });\n    } catch (error) {\n        console.error(\"Error in API route:\", error);\n        res.status(500).json({\n            error: \"An error occurred while processing your request\"\n        });\n    }\n}\nasync function handleSignIn(req, res) {\n    const { username, password } = req.body;\n    console.log(\"Signin attempt:\", {\n        username\n    });\n    try {\n        const [results] = await db.query(\"SELECT * FROM admin WHERE username = ?\", [\n            username\n        ]);\n        if (results.length === 0) {\n            console.log(\"User not found\");\n            return res.status(401).json({\n                error: \"Invalid username or password\"\n            });\n        }\n        const user = results[0];\n        const passwordMatch = password === user.password;\n        if (!passwordMatch) {\n            console.log(\"Password mismatch\");\n            return res.status(401).json({\n                error: \"Invalid username or password\"\n            });\n        }\n        // Insert new session record\n        await db.query(\"INSERT INTO admin_sessions (admin_id, login_time) VALUES (?, NOW())\", [\n            user.id\n        ]);\n        const token = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.sign)({\n            userId: user.id\n        }, process.env.JWT_SECRET, {\n            expiresIn: \"6h\"\n        });\n        console.log(\"Login successful, token generated\");\n        res.status(200).json({\n            success: true,\n            message: \"Signin successful\",\n            username: user.username,\n            token: token\n        });\n    } catch (error) {\n        console.error(\"Sign in error:\", error);\n        res.status(500).json({\n            error: \"An error occurred during signin\"\n        });\n    }\n}\nasync function handleValidatePin(req, res) {\n    const { pin } = req.body;\n    const token = req.headers.authorization?.split(\" \")[1];\n    if (!token) {\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    try {\n        const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, process.env.JWT_SECRET);\n        const [results] = await db.query(\"SELECT pin FROM admin WHERE id = ?\", [\n            decoded.userId\n        ]);\n        if (results.length === 0) {\n            return res.status(404).json({\n                error: \"Admin not found\"\n            });\n        }\n        const storedPin = results[0].pin;\n        if (String(pin) === String(storedPin)) {\n            res.status(200).json({\n                message: \"PIN validated successfully\"\n            });\n        } else {\n            res.status(401).json({\n                error: \"Invalid PIN\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error validating PIN:\", error);\n        res.status(500).json({\n            error: \"An error occurred while validating PIN\"\n        });\n    }\n}\nasync function handleLogout(req, res) {\n    const token = req.headers.authorization?.split(\" \")[1];\n    if (token) {\n        try {\n            const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, process.env.JWT_SECRET);\n            // Update logout_time for the most recent session\n            await db.query(`\r\n        UPDATE admin_sessions \r\n        SET logout_time = NOW() \r\n        WHERE admin_id = ? AND logout_time IS NULL \r\n        ORDER BY login_time DESC LIMIT 1\r\n      `, [\n                decoded.userId\n            ]);\n        } catch (error) {\n            console.error(\"Error during logout:\", error);\n        }\n    }\n    res.setHeader(\"Set-Cookie\", \"token=; Path=/; Expires=Thu, 01 Jan 1970 00:00:00 GMT; HttpOnly\");\n    res.status(200).json({\n        success: true,\n        message: \"Logout successful\"\n    });\n}\nasync function handleGetAdminData(req, res) {\n    try {\n        const [results] = await db.query(\"SELECT full_name, username, password, pin, role FROM admin LIMIT 1\");\n        if (results.length > 0) {\n            const adminData = results[0];\n            // Mask the password and PIN\n            adminData.password = \"*\".repeat(adminData.password.length);\n            adminData.pin = \"*\".repeat(adminData.pin.length);\n            res.status(200).json(adminData);\n        } else {\n            res.status(404).json({\n                error: \"Admin not found\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error fetching admin data:\", error);\n        res.status(500).json({\n            error: \"An error occurred while fetching admin data\"\n        });\n    }\n}\n// Update this function to hash the PIN before storing\nasync function handleUpdateAdminData(req, res) {\n    const { full_name, username, password, pin, role } = req.body;\n    try {\n        let sql = \"UPDATE admin SET full_name = ?, username = ?, role = ?\";\n        let params = [\n            full_name,\n            username,\n            role\n        ];\n        if (password) {\n            sql += \", password = ?\";\n            params.push(password);\n        }\n        if (pin) {\n            sql += \", pin = ?\";\n            params.push(pin);\n        }\n        sql += \" WHERE id = 1\"; // Assuming there's only one admin record\n        const result = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(sql, params);\n        if (result.affectedRows === 0) {\n            res.status(404).json({\n                error: \"Admin not found\"\n            });\n        } else {\n            res.status(200).json({\n                message: \"Admin data updated successfully\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error updating admin data:\", error);\n        res.status(500).json({\n            error: \"An error occurred while updating admin data\"\n        });\n    }\n}\nasync function handleGetSessionHistory(req, res) {\n    try {\n        const [results] = await db.query(`\r\n      SELECT \r\n        s.id, \r\n        a.full_name, \r\n        a.username, \r\n        s.login_time, \r\n        s.logout_time\r\n      FROM \r\n        admin_sessions s\r\n      JOIN \r\n        admin a ON s.admin_id = a.id\r\n      ORDER BY \r\n        s.login_time DESC \r\n      LIMIT 50\r\n    `);\n        res.status(200).json(results);\n    } catch (error) {\n        console.error(\"Error fetching session history:\", error);\n        res.status(500).json({\n            error: \"An error occurred while fetching session history\"\n        });\n    }\n}\nasync function handleGetSalesData(req, res) {\n    const { timeFrame } = req.query;\n    let dateCondition, statusCondition;\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    switch(timeFrame){\n        case \"today\":\n            dateCondition = \"DATE(order_date) = CURDATE()\";\n            break;\n        case \"yesterday\":\n            dateCondition = \"DATE(order_date) = DATE_SUB(CURDATE(), INTERVAL 1 DAY)\";\n            break;\n        case \"lastWeek\":\n            const lastWeekStart = new Date(today);\n            lastWeekStart.setDate(lastWeekStart.getDate() - 7);\n            const lastWeekEnd = new Date(today);\n            lastWeekEnd.setDate(lastWeekEnd.getDate() - 1);\n            dateCondition = `DATE(order_date) BETWEEN '${lastWeekStart.toISOString().split(\"T\")[0]}' AND '${lastWeekEnd.toISOString().split(\"T\")[0]}'`;\n            break;\n        case \"lastMonth\":\n            const lastMonthStart = new Date(today);\n            lastMonthStart.setMonth(lastMonthStart.getMonth() - 1);\n            const lastMonthEnd = new Date(today);\n            lastMonthEnd.setDate(lastMonthEnd.getDate() - 1);\n            dateCondition = `DATE(order_date) BETWEEN '${lastMonthStart.toISOString().split(\"T\")[0]}' AND '${lastMonthEnd.toISOString().split(\"T\")[0]}'`;\n            break;\n        default:\n            dateCondition = \"DATE(order_date) = CURDATE()\";\n    }\n    try {\n        // Total Sales (always only \"Delivered\" status)\n        const [salesResult] = await db.query(`\r\n      SELECT COALESCE(SUM(total), 0) as periodSales\r\n      FROM orders\r\n      WHERE ${dateCondition} AND status = 'Delivered'\r\n    `);\n        // Total Orders\n        let ordersStatusCondition = \"status = 'Delivered'\";\n        if (timeFrame === \"lastWeek\" || timeFrame === \"lastMonth\") {\n            ordersStatusCondition = \"status IN ('Order Placed', 'Processed', 'Shipped', 'Delivered', 'Cancelled')\";\n        }\n        const [ordersResult] = await db.query(`\r\n      SELECT COUNT(*) as totalOrders\r\n      FROM orders\r\n      WHERE ${dateCondition} AND ${ordersStatusCondition}\r\n    `);\n        // Total Customers (always all statuses)\n        const [customersResult] = await db.query(`\r\n      SELECT COUNT(DISTINCT user_id) as totalCustomers\r\n      FROM orders\r\n      WHERE ${dateCondition}\r\n    `);\n        const result = {\n            periodSales: Number(salesResult[0].periodSales),\n            totalOrders: ordersResult[0].totalOrders,\n            totalCustomers: customersResult[0].totalCustomers\n        };\n        res.status(200).json(result);\n    } catch (error) {\n        console.error(\"Error fetching sales data:\", error);\n        res.status(500).json({\n            error: \"Error fetching sales data\"\n        });\n    }\n}\nasync function handleGetTotalProducts(req, res) {\n    const [result] = await db.query(\"SELECT COUNT(*) as totalProducts FROM products\");\n    res.status(200).json(result[0]);\n}\nasync function handleGetTopProducts(req, res) {\n    const [result] = await db.query(`\r\n    SELECT \r\n      p.id,\r\n      p.name,\r\n      p.image_url,\r\n      COALESCE(AVG(pr.rating), 0) as avg_rating,\r\n      COALESCE(SUM(op.quantity), 0) as sold\r\n    FROM products p\r\n    LEFT JOIN ordered_products op ON p.id = op.product_id\r\n    LEFT JOIN product_ratings pr ON p.id = pr.product_id\r\n    GROUP BY p.id\r\n    ORDER BY sold DESC, avg_rating DESC\r\n    LIMIT 5\r\n  `);\n    const formattedResult = result.map((product)=>({\n            ...product,\n            avg_rating: Number(product.avg_rating).toFixed(1)\n        }));\n    res.status(200).json(formattedResult);\n}\nasync function handleGetRatedProductsCount(req, res) {\n    const { timeFrame } = req.query;\n    let dateCondition;\n    switch(timeFrame){\n        case \"today\":\n            dateCondition = \"DATE(created_at) = CURDATE()\";\n            break;\n        case \"yesterday\":\n            dateCondition = \"DATE(created_at) = DATE_SUB(CURDATE(), INTERVAL 1 DAY)\";\n            break;\n        case \"lastWeek\":\n            dateCondition = \"DATE(created_at) BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 WEEK) AND CURDATE()\";\n            break;\n        case \"lastMonth\":\n            dateCondition = \"DATE(created_at) BETWEEN DATE_SUB(CURDATE(), INTERVAL 1 MONTH) AND CURDATE()\";\n            break;\n        default:\n            dateCondition = \"DATE(created_at) = CURDATE()\";\n    }\n    const [result] = await db.query(`\r\n    SELECT COUNT(DISTINCT product_id) as ratedProductsCount\r\n    FROM product_ratings\r\n    WHERE ${dateCondition}\r\n  `);\n    res.status(200).json(result[0]);\n}\nasync function handleGetProducts(req, res) {\n    const { page = 1, limit = 10 } = req.query;\n    const offset = (page - 1) * limit;\n    try {\n        const [countResult] = await db.query(\"SELECT COUNT(*) as total FROM products WHERE deleted = FALSE\");\n        const totalItems = countResult[0].total;\n        const totalPages = Math.ceil(totalItems / limit);\n        const [products] = await db.query(\"SELECT * FROM products WHERE deleted = FALSE LIMIT ? OFFSET ?\", [\n            parseInt(limit),\n            offset\n        ]);\n        res.status(200).json({\n            products,\n            currentPage: parseInt(page),\n            totalPages,\n            totalItems\n        });\n    } catch (error) {\n        console.error(\"Error fetching products:\", error);\n        res.status(500).json({\n            error: \"Error fetching products\"\n        });\n    }\n}\nasync function handleGetTotalStock(req, res) {\n    try {\n        const [result] = await db.query(\"SELECT SUM(stock_quantity) as totalStock FROM products\");\n        res.status(200).json({\n            totalStock: result[0].totalStock\n        });\n    } catch (error) {\n        console.error(\"Error fetching total stock:\", error);\n        res.status(500).json({\n            error: \"Error fetching total stock\"\n        });\n    }\n}\nasync function handleAddProduct(req, res) {\n    const { name, description, price, image_url, stock_quantity, category, supplier_id } = req.body;\n    const order_id = generateOrderId();\n    const sql = \"INSERT INTO products (name, description, price, image_url, stock_quantity, category, supplier_id, order_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?)\";\n    try {\n        const [result] = await db.query(sql, [\n            name,\n            description,\n            price,\n            image_url,\n            stock_quantity,\n            category,\n            supplier_id,\n            order_id\n        ]);\n        res.status(201).json({\n            message: \"Product added successfully\",\n            id: result.insertId,\n            order_id: order_id\n        });\n    } catch (error) {\n        console.error(\"Error adding product:\", error);\n        res.status(500).json({\n            error: \"Error adding product\"\n        });\n    }\n}\nfunction generateOrderId() {\n    return \"ORD-\" + Math.random().toString(36).substr(2, 9).toUpperCase();\n}\nasync function handleUpdateProduct(req, res, id) {\n    const { name, description, price, image_url, stock_quantity, category, supplier_id } = req.body;\n    const sql = \"UPDATE products SET name=?, description=?, price=?, image_url=?, stock_quantity=?, category=?, supplier_id=? WHERE id=?\";\n    try {\n        const [result] = await db.query(sql, [\n            name,\n            description,\n            price,\n            image_url,\n            stock_quantity,\n            category,\n            supplier_id,\n            id\n        ]);\n        if (result.affectedRows === 0) {\n            res.status(404).json({\n                error: \"Product not found\"\n            });\n        } else {\n            res.status(200).json({\n                message: \"Product updated successfully\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error updating product:\", error);\n        res.status(500).json({\n            error: \"Error updating product\"\n        });\n    }\n}\nasync function handleDeleteProduct(req, res, id) {\n    const sql = \"UPDATE products SET deleted = TRUE WHERE id = ?\";\n    try {\n        const [result] = await db.query(sql, [\n            id\n        ]);\n        if (result.affectedRows === 0) {\n            res.status(404).json({\n                error: \"Product not found\"\n            });\n        } else {\n            res.status(200).json({\n                message: \"Product marked as deleted successfully\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error marking product as deleted:\", error);\n        res.status(500).json({\n            error: \"Error marking product as deleted\"\n        });\n    }\n}\nasync function handleGetSalesReport(req, res) {\n    try {\n        const [result] = await db.query(\"SELECT * FROM user_login\");\n        res.status(200).json(result);\n    } catch (error) {\n        console.error(\"Error fetching sales report:\", error);\n        res.status(500).json({\n            error: \"An error occurred while fetching sales report data\"\n        });\n    }\n}\nasync function handleUpdateOrderStatus(req, res, id) {\n    const { status } = req.body;\n    console.log(\"Updating order status:\", id, status);\n    const sql = \"UPDATE orders SET status = ? WHERE id = ?\";\n    try {\n        const [result] = await db.query(sql, [\n            status,\n            id\n        ]);\n        if (result.affectedRows === 0) {\n            res.status(404).json({\n                error: \"Order not found\"\n            });\n        } else {\n            res.status(200).json({\n                message: \"Order status updated successfully\",\n                status: status\n            });\n        }\n    } catch (error) {\n        console.error(\"Error updating order status:\", error);\n        res.status(500).json({\n            error: \"Error updating order status\"\n        });\n    }\n}\nasync function handleCancelOrder(req, res, id) {\n    const sql = \"UPDATE orders SET status = 'Cancelled' WHERE id = ?\";\n    try {\n        const [result] = await db.query(sql, [\n            id\n        ]);\n        if (result.affectedRows === 0) {\n            res.status(404).json({\n                error: \"Order not found\"\n            });\n        } else {\n            res.status(200).json({\n                message: \"Order cancelled successfully\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error cancelling order:\", error);\n        res.status(500).json({\n            error: \"Error cancelling order\"\n        });\n    }\n}\nasync function handleUpdateOrder(req, res, id) {\n    const { order_date } = req.body;\n    const sql = \"UPDATE orders SET order_date = ? WHERE id = ?\";\n    try {\n        const [result] = await db.query(sql, [\n            order_date,\n            id\n        ]);\n        if (result.affectedRows === 0) {\n            res.status(404).json({\n                error: \"Order not found\"\n            });\n        } else {\n            res.status(200).json({\n                message: \"Order date updated successfully\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error updating order date:\", error);\n        res.status(500).json({\n            error: \"Error updating order date\"\n        });\n    }\n}\nasync function handleRemoveOrderFromSalesReport(req, res) {\n    const { id } = req.query;\n    const sql = \"UPDATE orders SET in_sales_report = 0 WHERE id = ?\";\n    try {\n        const [result] = await db.query(sql, [\n            id\n        ]);\n        if (result.affectedRows === 0) {\n            res.status(404).json({\n                error: \"Order not found\"\n            });\n        } else {\n            res.status(200).json({\n                message: \"Order removed from sales report successfully\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error removing order from sales report:\", error);\n        res.status(500).json({\n            error: \"Error removing order from sales report\"\n        });\n    }\n}\nasync function handleGetOrders(req, res) {\n    try {\n        const [result] = await db.query(`\r\n      SELECT o.*, \r\n             GROUP_CONCAT(CONCAT(op.name, ' (', op.quantity, ')') SEPARATOR ', ') AS ordered_products\r\n      FROM orders o\r\n      LEFT JOIN ordered_products op ON o.id = op.order_id\r\n      WHERE o.in_sales_report = 1\r\n      GROUP BY o.id\r\n    `);\n        res.status(200).json(result);\n    } catch (error) {\n        console.error(\"Error fetching orders:\", error);\n        res.status(500).json({\n            error: \"An error occurred while fetching orders\"\n        });\n    }\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvcGFnZXMvYXBpL1suLi5uZXh0YXBpXS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBbUM7QUFDUDtBQUNnQjtBQUNMO0FBRXZDLE1BQU1LLEtBQUtMLGdFQUFnQixDQUFDO0lBQzFCTyxNQUFNQyxRQUFRQyxHQUFHLENBQUNDLFVBQVU7SUFDNUJDLE1BQU1ILFFBQVFDLEdBQUcsQ0FBQ0csVUFBVTtJQUM1QkMsTUFBTUwsUUFBUUMsR0FBRyxDQUFDSyxVQUFVO0lBQzVCQyxVQUFVUCxRQUFRQyxHQUFHLENBQUNPLGNBQWM7SUFDcENDLFVBQVVULFFBQVFDLEdBQUcsQ0FBQ1MsY0FBYztJQUNwQ0Msb0JBQW9CO0lBQ3BCQyxpQkFBaUI7SUFDakJDLFlBQVk7QUFDZDtBQUVlLGVBQWVDLFFBQVFDLEdBQUcsRUFBRUMsR0FBRztJQUM1QyxNQUFNLEVBQUVDLE1BQU0sRUFBRSxHQUFHRjtJQUNuQixNQUFNLEVBQUVHLFFBQVEsRUFBRXRCLEtBQUssRUFBRSxHQUFHSCwwQ0FBS0EsQ0FBQ3NCLElBQUlJLEdBQUcsRUFBRTtJQUUzQ0MsUUFBUUMsR0FBRyxDQUFDLHFCQUFxQkosUUFBUUMsVUFBVXRCO0lBRW5ELElBQUlzQixhQUFhLGFBQWE7UUFDNUJGLElBQUlNLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsU0FBUztRQUFxQjtRQUNyRDtJQUNGO0lBRUEsSUFBSU4sYUFBYSxtQkFBbUI7UUFDbEMsSUFBSTtZQUNGLE1BQU0sQ0FBQ08sUUFBUSxHQUFHLE1BQU01QixHQUFHRCxLQUFLLENBQUM7WUFDakMsSUFBSTZCLFFBQVFDLE1BQU0sR0FBRyxHQUFHO2dCQUN0QlYsSUFBSU0sTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztvQkFBRUksVUFBVUYsT0FBTyxDQUFDLEVBQUUsQ0FBQ0csU0FBUztnQkFBQztZQUN4RCxPQUFPO2dCQUNMWixJQUFJTSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO29CQUFFTSxPQUFPO2dCQUFr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O1lBQzdCeEUsSUFBSU0sTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFBRU0sT0FBTztZQUFrQjtRQUNsRCxPQUFPO1lBQ0xiLElBQUlNLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUVDLFNBQVM7WUFBK0M7UUFDakY7SUFDRixFQUFFLE9BQU9LLE9BQU87UUFDZFQsUUFBUVMsS0FBSyxDQUFDLDJDQUEyQ0E7UUFDekRiLElBQUlNLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRU0sT0FBTztRQUF5QztJQUN6RTtBQUNGO0FBRUEsZUFBZXdCLGdCQUFnQnRDLEdBQUcsRUFBRUMsR0FBRztJQUNyQyxJQUFJO1FBQ0YsTUFBTSxDQUFDdUUsT0FBTyxHQUFHLE1BQU0xRixHQUFHRCxLQUFLLENBQUMsQ0FBQzs7Ozs7OztJQU9qQyxDQUFDO1FBQ0RvQixJQUFJTSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDZ0U7SUFDdkIsRUFBRSxPQUFPMUQsT0FBTztRQUNkVCxRQUFRUyxLQUFLLENBQUMsMEJBQTBCQTtRQUN4Q2IsSUFBSU0sTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFTSxPQUFPO1FBQTBDO0lBQzFFO0FBQ0Y7QUFHaUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hZG1pbnBhbmVsLy4vc3JjL3BhZ2VzL2FwaS9bLi4ubmV4dGFwaV0uanM/Mjg3OSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbXlzcWwgZnJvbSAnbXlzcWwyL3Byb21pc2UnO1xyXG5pbXBvcnQgeyBwYXJzZSB9IGZyb20gJ3VybCc7XHJcbmltcG9ydCB7IHNpZ24sIHZlcmlmeSB9IGZyb20gJ2pzb253ZWJ0b2tlbic7XHJcbmltcG9ydCB7IHF1ZXJ5IH0gZnJvbSAnLi4vLi4vdXRpbHMvZGInO1xyXG5cclxuY29uc3QgZGIgPSBteXNxbC5jcmVhdGVQb29sKHtcclxuICBob3N0OiBwcm9jZXNzLmVudi5NWVNRTF9IT1NULFxyXG4gIHBvcnQ6IHByb2Nlc3MuZW52Lk1ZU1FMX1BPUlQsXHJcbiAgdXNlcjogcHJvY2Vzcy5lbnYuTVlTUUxfVVNFUixcclxuICBwYXNzd29yZDogcHJvY2Vzcy5lbnYuTVlTUUxfUEFTU1dPUkQsXHJcbiAgZGF0YWJhc2U6IHByb2Nlc3MuZW52Lk1ZU1FMX0RBVEFCQVNFLFxyXG4gIHdhaXRGb3JDb25uZWN0aW9uczogdHJ1ZSxcclxuICBjb25uZWN0aW9uTGltaXQ6IDEwLFxyXG4gIHF1ZXVlTGltaXQ6IDBcclxufSk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzKSB7XHJcbiAgY29uc3QgeyBtZXRob2QgfSA9IHJlcTtcclxuICBjb25zdCB7IHBhdGhuYW1lLCBxdWVyeSB9ID0gcGFyc2UocmVxLnVybCwgdHJ1ZSk7XHJcblxyXG4gIGNvbnNvbGUubG9nKCdSZWNlaXZlZCByZXF1ZXN0OicsIG1ldGhvZCwgcGF0aG5hbWUsIHF1ZXJ5KTtcclxuXHJcbiAgaWYgKHBhdGhuYW1lID09PSAnL2FwaS90ZXN0Jykge1xyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBtZXNzYWdlOiAnVGVzdCByb3V0ZSB3b3JraW5nJyB9KTtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvYWRtaW4tbmFtZScpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IFtyZXN1bHRzXSA9IGF3YWl0IGRiLnF1ZXJ5KCdTRUxFQ1QgZnVsbF9uYW1lIEZST00gYWRtaW4gTElNSVQgMScpO1xyXG4gICAgICBpZiAocmVzdWx0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBmdWxsTmFtZTogcmVzdWx0c1swXS5mdWxsX25hbWUgfSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvcjogJ0FkbWluIG5vdCBmb3VuZCcgfSk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGFkbWluIG5hbWU6JywgZXJyb3IpO1xyXG4gICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgZmV0Y2hpbmcgYWRtaW4gbmFtZScgfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgc3dpdGNoIChtZXRob2QpIHtcclxuICAgICAgY2FzZSAnR0VUJzpcclxuICAgIFxyXG4gICAgICAgIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvY2hlY2stYXV0aCcpIHtcclxuICAgICAgICAgIGNvbnN0IGF1dGhIZWFkZXIgPSByZXEuaGVhZGVycy5hdXRob3JpemF0aW9uO1xyXG4gICAgICAgICAgaWYgKCFhdXRoSGVhZGVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7IGlzQXV0aGVudGljYXRlZDogZmFsc2UsIHVzZXJuYW1lUGFzc3dvcmRWZXJpZmllZDogZmFsc2UgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgICBjb25zdCB0b2tlbiA9IGF1dGhIZWFkZXIuc3BsaXQoJyAnKVsxXTtcclxuICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRlY29kZWQgPSB2ZXJpZnkodG9rZW4sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQpO1xyXG4gICAgICAgICAgICBjb25zdCBub3cgPSBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmIChkZWNvZGVkLmV4cCAmJiBkZWNvZGVkLmV4cCA+IG5vdykge1xyXG4gICAgICAgICAgICAgIC8vIFRva2VuIGlzIHN0aWxsIHZhbGlkXHJcbiAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgXHJcbiAgICAgICAgICAgICAgICBpc0F1dGhlbnRpY2F0ZWQ6IHRydWUsIFxyXG4gICAgICAgICAgICAgICAgdXNlcm5hbWVQYXNzd29yZFZlcmlmaWVkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgZXhwaXJlc0luOiBkZWNvZGVkLmV4cCAtIG5vd1xyXG4gICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIC8vIFRva2VuIGhhcyBleHBpcmVkXHJcbiAgICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgaXNBdXRoZW50aWNhdGVkOiBmYWxzZSwgdXNlcm5hbWVQYXNzd29yZFZlcmlmaWVkOiBmYWxzZSB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgaXNBdXRoZW50aWNhdGVkOiBmYWxzZSwgdXNlcm5hbWVQYXNzd29yZFZlcmlmaWVkOiBmYWxzZSB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9wcm9kdWN0cycpIHtcclxuICAgICAgICAgIGF3YWl0IGhhbmRsZUdldFByb2R1Y3RzKHJlcSwgcmVzKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS90b3RhbC1zdG9jaycpIHtcclxuICAgICAgICAgIGF3YWl0IGhhbmRsZUdldFRvdGFsU3RvY2socmVxLCByZXMpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUgPT09ICcvYXBpL3NhbGVzLXJlcG9ydCcpIHtcclxuICAgICAgICAgIGF3YWl0IGhhbmRsZUdldFNhbGVzUmVwb3J0KHJlcSwgcmVzKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9zYWxlcy1kYXRhJykge1xyXG4gICAgICAgICAgYXdhaXQgaGFuZGxlR2V0U2FsZXNEYXRhKHJlcSwgcmVzKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS90b3RhbC1wcm9kdWN0cycpIHtcclxuICAgICAgICAgIGF3YWl0IGhhbmRsZUdldFRvdGFsUHJvZHVjdHMocmVxLCByZXMpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUgPT09ICcvYXBpL3RvcC1wcm9kdWN0cycpIHtcclxuICAgICAgICAgIGF3YWl0IGhhbmRsZUdldFRvcFByb2R1Y3RzKHJlcSwgcmVzKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9yYXRlZC1wcm9kdWN0cy1jb3VudCcpIHtcclxuICAgICAgICAgIGF3YWl0IGhhbmRsZUdldFJhdGVkUHJvZHVjdHNDb3VudChyZXEsIHJlcyk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvbG9nb3V0Jykge1xyXG4gICAgICAgICAgYXdhaXQgaGFuZGxlTG9nb3V0KHJlcSwgcmVzKTtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9vcmRlcnMnKSB7XHJcbiAgICAgICAgICBhd2FpdCBoYW5kbGVHZXRPcmRlcnMocmVxLCByZXMpO1xyXG4gICAgICAgIH0gZWxzZSAgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9hZG1pbi1kYXRhJykge1xyXG4gICAgICAgICAgYXdhaXQgaGFuZGxlR2V0QWRtaW5EYXRhKHJlcSwgcmVzKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9zZXNzaW9uLWhpc3RvcnknKSB7XHJcbiAgICAgICAgICBhd2FpdCBoYW5kbGVHZXRTZXNzaW9uSGlzdG9yeShyZXEsIHJlcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSAnUE9TVCc6XHJcbiAgICAgICAgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9zaWduaW4nKSB7XHJcbiAgICAgICAgICBhd2FpdCBoYW5kbGVTaWduSW4ocmVxLCByZXMpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUgPT09ICcvYXBpL3ZhbGlkYXRlLXBpbicpIHtcclxuICAgICAgICAgIGF3YWl0IGhhbmRsZVZhbGlkYXRlUGluKHJlcSwgcmVzKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9wcm9kdWN0cycpIHtcclxuICAgICAgICAgIGF3YWl0IGhhbmRsZUFkZFByb2R1Y3QocmVxLCByZXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgY2FzZSAnUFVUJzpcclxuICBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aCgnL2FwaS9wcm9kdWN0cy8nKSkge1xyXG4gICAgY29uc3QgaWQgPSBwYXRobmFtZS5zcGxpdCgnLycpLnBvcCgpO1xyXG4gICAgYXdhaXQgaGFuZGxlVXBkYXRlUHJvZHVjdChyZXEsIHJlcywgaWQpO1xyXG4gIH0gZWxzZSBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aCgnL2FwaS9vcmRlcnMvJykpIHtcclxuICAgIGNvbnN0IHBhcnRzID0gcGF0aG5hbWUuc3BsaXQoJy8nKTtcclxuICAgIGNvbnN0IGlkID0gcGFydHNbM107IC8vIFRoaXMgaXMgdGhlIG9yZGVyIElEXHJcbiAgICBpZiAocGFydHNbNF0gPT09ICdzdGF0dXMnKSB7XHJcbiAgICAgIGF3YWl0IGhhbmRsZVVwZGF0ZU9yZGVyU3RhdHVzKHJlcSwgcmVzLCBpZCk7XHJcbiAgICB9IGVsc2UgaWYgKHBhcnRzWzRdID09PSAnY2FuY2VsJykge1xyXG4gICAgICBhd2FpdCBoYW5kbGVDYW5jZWxPcmRlcihyZXEsIHJlcywgaWQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgYXdhaXQgaGFuZGxlVXBkYXRlT3JkZXIocmVxLCByZXMsIGlkKTtcclxuICAgIH1cclxuICB9XHJcbiAgaWYgKHBhdGhuYW1lID09PSAnL2FwaS91cGRhdGUtYWRtaW4nKSB7XHJcbiAgICBhd2FpdCBoYW5kbGVVcGRhdGVBZG1pbkRhdGEocmVxLCByZXMpO1xyXG4gIH1cclxuICBicmVhaztcclxuICBjYXNlICdERUxFVEUnOlxyXG4gICAgICAgIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKCcvYXBpL3Byb2R1Y3RzLycpKSB7XHJcbiAgICAgICAgICBjb25zdCBpZCA9IHBhdGhuYW1lLnNwbGl0KCcvJykucG9wKCk7XHJcbiAgICAgICAgICBhd2FpdCBoYW5kbGVEZWxldGVQcm9kdWN0KHJlcSwgcmVzLCBpZCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKCcvYXBpL29yZGVycy8nKSAmJiBwYXRobmFtZS5lbmRzV2l0aCgnL3NhbGVzcmVwb3J0JykpIHtcclxuICAgICAgICAgIGF3YWl0IGhhbmRsZVJlbW92ZU9yZGVyRnJvbVNhbGVzUmVwb3J0KHJlcSwgcmVzKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvcjogJ1JvdXRlIG5vdCBmb3VuZCcgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICByZXMuc2V0SGVhZGVyKCdBbGxvdycsIFsnR0VUJywgJ1BPU1QnLCAnUFVUJywgJ0RFTEVURSddKTtcclxuICAgICAgICByZXMuc3RhdHVzKDQwNSkuZW5kKGBNZXRob2QgJHttZXRob2R9IE5vdCBBbGxvd2VkYCk7XHJcbiAgICB9XHJcblxyXG4gIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdSb3V0ZSBub3QgZm91bmQnIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBBUEkgcm91dGU6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0FuIGVycm9yIG9jY3VycmVkIHdoaWxlIHByb2Nlc3NpbmcgeW91ciByZXF1ZXN0JyB9KTtcclxuICB9XHJcbn1cclxuXHJcblxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlU2lnbkluKHJlcSwgcmVzKSB7XHJcbiAgY29uc3QgeyB1c2VybmFtZSwgcGFzc3dvcmQgfSA9IHJlcS5ib2R5O1xyXG4gIGNvbnNvbGUubG9nKCdTaWduaW4gYXR0ZW1wdDonLCB7IHVzZXJuYW1lIH0pO1xyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgW3Jlc3VsdHNdID0gYXdhaXQgZGIucXVlcnkoJ1NFTEVDVCAqIEZST00gYWRtaW4gV0hFUkUgdXNlcm5hbWUgPSA/JywgW3VzZXJuYW1lXSk7XHJcblxyXG4gICAgaWYgKHJlc3VsdHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdVc2VyIG5vdCBmb3VuZCcpO1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ0ludmFsaWQgdXNlcm5hbWUgb3IgcGFzc3dvcmQnIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHVzZXIgPSByZXN1bHRzWzBdO1xyXG4gICAgXHJcbiAgICBjb25zdCBwYXNzd29yZE1hdGNoID0gcGFzc3dvcmQgPT09IHVzZXIucGFzc3dvcmQ7XHJcblxyXG4gICAgaWYgKCFwYXNzd29yZE1hdGNoKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdQYXNzd29yZCBtaXNtYXRjaCcpO1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ0ludmFsaWQgdXNlcm5hbWUgb3IgcGFzc3dvcmQnIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEluc2VydCBuZXcgc2Vzc2lvbiByZWNvcmRcclxuICAgIGF3YWl0IGRiLnF1ZXJ5KCdJTlNFUlQgSU5UTyBhZG1pbl9zZXNzaW9ucyAoYWRtaW5faWQsIGxvZ2luX3RpbWUpIFZBTFVFUyAoPywgTk9XKCkpJywgW3VzZXIuaWRdKTtcclxuXHJcbiAgICBjb25zdCB0b2tlbiA9IHNpZ24oeyB1c2VySWQ6IHVzZXIuaWQgfSwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCwgeyBleHBpcmVzSW46ICc2aCcgfSk7XHJcbiAgICBjb25zb2xlLmxvZygnTG9naW4gc3VjY2Vzc2Z1bCwgdG9rZW4gZ2VuZXJhdGVkJyk7XHJcbiAgICBcclxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgc3VjY2VzczogdHJ1ZSwgbWVzc2FnZTogJ1NpZ25pbiBzdWNjZXNzZnVsJywgdXNlcm5hbWU6IHVzZXIudXNlcm5hbWUsIHRva2VuOiB0b2tlbiB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignU2lnbiBpbiBlcnJvcjonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnQW4gZXJyb3Igb2NjdXJyZWQgZHVyaW5nIHNpZ25pbicgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVWYWxpZGF0ZVBpbihyZXEsIHJlcykge1xyXG4gIGNvbnN0IHsgcGluIH0gPSByZXEuYm9keTtcclxuICBjb25zdCB0b2tlbiA9IHJlcS5oZWFkZXJzLmF1dGhvcml6YXRpb24/LnNwbGl0KCcgJylbMV07XHJcblxyXG4gIGlmICghdG9rZW4pIHtcclxuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnTm8gdG9rZW4gcHJvdmlkZWQnIH0pO1xyXG4gIH1cclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGRlY29kZWQgPSB2ZXJpZnkodG9rZW4sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQpO1xyXG4gICAgY29uc3QgW3Jlc3VsdHNdID0gYXdhaXQgZGIucXVlcnkoJ1NFTEVDVCBwaW4gRlJPTSBhZG1pbiBXSEVSRSBpZCA9ID8nLCBbZGVjb2RlZC51c2VySWRdKTtcclxuICAgIFxyXG4gICAgaWYgKHJlc3VsdHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnQWRtaW4gbm90IGZvdW5kJyB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBzdG9yZWRQaW4gPSByZXN1bHRzWzBdLnBpbjtcclxuICAgIFxyXG4gICAgaWYgKFN0cmluZyhwaW4pID09PSBTdHJpbmcoc3RvcmVkUGluKSkge1xyXG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IG1lc3NhZ2U6ICdQSU4gdmFsaWRhdGVkIHN1Y2Nlc3NmdWxseScgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnSW52YWxpZCBQSU4nIH0pO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB2YWxpZGF0aW5nIFBJTjonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgdmFsaWRhdGluZyBQSU4nIH0pO1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlTG9nb3V0KHJlcSwgcmVzKSB7XHJcbiAgY29uc3QgdG9rZW4gPSByZXEuaGVhZGVycy5hdXRob3JpemF0aW9uPy5zcGxpdCgnICcpWzFdO1xyXG4gIGlmICh0b2tlbikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgZGVjb2RlZCA9IHZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCk7XHJcbiAgICAgIC8vIFVwZGF0ZSBsb2dvdXRfdGltZSBmb3IgdGhlIG1vc3QgcmVjZW50IHNlc3Npb25cclxuICAgICAgYXdhaXQgZGIucXVlcnkoYFxyXG4gICAgICAgIFVQREFURSBhZG1pbl9zZXNzaW9ucyBcclxuICAgICAgICBTRVQgbG9nb3V0X3RpbWUgPSBOT1coKSBcclxuICAgICAgICBXSEVSRSBhZG1pbl9pZCA9ID8gQU5EIGxvZ291dF90aW1lIElTIE5VTEwgXHJcbiAgICAgICAgT1JERVIgQlkgbG9naW5fdGltZSBERVNDIExJTUlUIDFcclxuICAgICAgYCwgW2RlY29kZWQudXNlcklkXSk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkdXJpbmcgbG9nb3V0OicsIGVycm9yKTtcclxuICAgIH1cclxuICB9XHJcbiAgcmVzLnNldEhlYWRlcignU2V0LUNvb2tpZScsICd0b2tlbj07IFBhdGg9LzsgRXhwaXJlcz1UaHUsIDAxIEphbiAxOTcwIDAwOjAwOjAwIEdNVDsgSHR0cE9ubHknKTtcclxuICByZXMuc3RhdHVzKDIwMCkuanNvbih7IHN1Y2Nlc3M6IHRydWUsIG1lc3NhZ2U6ICdMb2dvdXQgc3VjY2Vzc2Z1bCcgfSk7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUdldEFkbWluRGF0YShyZXEsIHJlcykge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbcmVzdWx0c10gPSBhd2FpdCBkYi5xdWVyeSgnU0VMRUNUIGZ1bGxfbmFtZSwgdXNlcm5hbWUsIHBhc3N3b3JkLCBwaW4sIHJvbGUgRlJPTSBhZG1pbiBMSU1JVCAxJyk7XHJcbiAgICBpZiAocmVzdWx0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGNvbnN0IGFkbWluRGF0YSA9IHJlc3VsdHNbMF07XHJcbiAgICAgIC8vIE1hc2sgdGhlIHBhc3N3b3JkIGFuZCBQSU5cclxuICAgICAgYWRtaW5EYXRhLnBhc3N3b3JkID0gJyonLnJlcGVhdChhZG1pbkRhdGEucGFzc3dvcmQubGVuZ3RoKTtcclxuICAgICAgYWRtaW5EYXRhLnBpbiA9ICcqJy5yZXBlYXQoYWRtaW5EYXRhLnBpbi5sZW5ndGgpO1xyXG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbihhZG1pbkRhdGEpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvcjogJ0FkbWluIG5vdCBmb3VuZCcgfSk7XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGFkbWluIGRhdGE6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0FuIGVycm9yIG9jY3VycmVkIHdoaWxlIGZldGNoaW5nIGFkbWluIGRhdGEnIH0pO1xyXG4gIH1cclxufVxyXG5cclxuLy8gVXBkYXRlIHRoaXMgZnVuY3Rpb24gdG8gaGFzaCB0aGUgUElOIGJlZm9yZSBzdG9yaW5nXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZVVwZGF0ZUFkbWluRGF0YShyZXEsIHJlcykge1xyXG4gIGNvbnN0IHsgZnVsbF9uYW1lLCB1c2VybmFtZSwgcGFzc3dvcmQsIHBpbiwgcm9sZSB9ID0gcmVxLmJvZHk7XHJcbiAgXHJcbiAgdHJ5IHtcclxuICAgIGxldCBzcWwgPSAnVVBEQVRFIGFkbWluIFNFVCBmdWxsX25hbWUgPSA/LCB1c2VybmFtZSA9ID8sIHJvbGUgPSA/JztcclxuICAgIGxldCBwYXJhbXMgPSBbZnVsbF9uYW1lLCB1c2VybmFtZSwgcm9sZV07XHJcblxyXG4gICAgaWYgKHBhc3N3b3JkKSB7XHJcbiAgICAgIHNxbCArPSAnLCBwYXNzd29yZCA9ID8nO1xyXG4gICAgICBwYXJhbXMucHVzaChwYXNzd29yZCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHBpbikge1xyXG4gICAgICBzcWwgKz0gJywgcGluID0gPyc7XHJcbiAgICAgIHBhcmFtcy5wdXNoKHBpbik7XHJcbiAgICB9XHJcblxyXG4gICAgc3FsICs9ICcgV0hFUkUgaWQgPSAxJzsgLy8gQXNzdW1pbmcgdGhlcmUncyBvbmx5IG9uZSBhZG1pbiByZWNvcmRcclxuXHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBxdWVyeShzcWwsIHBhcmFtcyk7XHJcblxyXG4gICAgaWYgKHJlc3VsdC5hZmZlY3RlZFJvd3MgPT09IDApIHtcclxuICAgICAgcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvcjogJ0FkbWluIG5vdCBmb3VuZCcgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IG1lc3NhZ2U6ICdBZG1pbiBkYXRhIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5JyB9KTtcclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgYWRtaW4gZGF0YTonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgdXBkYXRpbmcgYWRtaW4gZGF0YScgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVHZXRTZXNzaW9uSGlzdG9yeShyZXEsIHJlcykge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbcmVzdWx0c10gPSBhd2FpdCBkYi5xdWVyeShgXHJcbiAgICAgIFNFTEVDVCBcclxuICAgICAgICBzLmlkLCBcclxuICAgICAgICBhLmZ1bGxfbmFtZSwgXHJcbiAgICAgICAgYS51c2VybmFtZSwgXHJcbiAgICAgICAgcy5sb2dpbl90aW1lLCBcclxuICAgICAgICBzLmxvZ291dF90aW1lXHJcbiAgICAgIEZST00gXHJcbiAgICAgICAgYWRtaW5fc2Vzc2lvbnMgc1xyXG4gICAgICBKT0lOIFxyXG4gICAgICAgIGFkbWluIGEgT04gcy5hZG1pbl9pZCA9IGEuaWRcclxuICAgICAgT1JERVIgQlkgXHJcbiAgICAgICAgcy5sb2dpbl90aW1lIERFU0MgXHJcbiAgICAgIExJTUlUIDUwXHJcbiAgICBgKTtcclxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHJlc3VsdHMpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBzZXNzaW9uIGhpc3Rvcnk6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0FuIGVycm9yIG9jY3VycmVkIHdoaWxlIGZldGNoaW5nIHNlc3Npb24gaGlzdG9yeScgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5cclxuXHJcblxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlR2V0U2FsZXNEYXRhKHJlcSwgcmVzKSB7XHJcbiAgY29uc3QgeyB0aW1lRnJhbWUgfSA9IHJlcS5xdWVyeTtcclxuICBsZXQgZGF0ZUNvbmRpdGlvbiwgc3RhdHVzQ29uZGl0aW9uO1xyXG4gIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKTtcclxuICB0b2RheS5zZXRIb3VycygwLCAwLCAwLCAwKTtcclxuXHJcbiAgc3dpdGNoICh0aW1lRnJhbWUpIHtcclxuICAgIGNhc2UgJ3RvZGF5JzpcclxuICAgICAgZGF0ZUNvbmRpdGlvbiA9ICdEQVRFKG9yZGVyX2RhdGUpID0gQ1VSREFURSgpJztcclxuICAgICAgYnJlYWs7XHJcbiAgICBjYXNlICd5ZXN0ZXJkYXknOlxyXG4gICAgICBkYXRlQ29uZGl0aW9uID0gJ0RBVEUob3JkZXJfZGF0ZSkgPSBEQVRFX1NVQihDVVJEQVRFKCksIElOVEVSVkFMIDEgREFZKSc7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSAnbGFzdFdlZWsnOlxyXG4gICAgICBjb25zdCBsYXN0V2Vla1N0YXJ0ID0gbmV3IERhdGUodG9kYXkpO1xyXG4gICAgICBsYXN0V2Vla1N0YXJ0LnNldERhdGUobGFzdFdlZWtTdGFydC5nZXREYXRlKCkgLSA3KTtcclxuICAgICAgY29uc3QgbGFzdFdlZWtFbmQgPSBuZXcgRGF0ZSh0b2RheSk7XHJcbiAgICAgIGxhc3RXZWVrRW5kLnNldERhdGUobGFzdFdlZWtFbmQuZ2V0RGF0ZSgpIC0gMSk7XHJcbiAgICAgIGRhdGVDb25kaXRpb24gPSBgREFURShvcmRlcl9kYXRlKSBCRVRXRUVOICcke2xhc3RXZWVrU3RhcnQudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdfScgQU5EICcke2xhc3RXZWVrRW5kLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXX0nYDtcclxuICAgICAgYnJlYWs7XHJcbiAgICBjYXNlICdsYXN0TW9udGgnOlxyXG4gICAgICBjb25zdCBsYXN0TW9udGhTdGFydCA9IG5ldyBEYXRlKHRvZGF5KTtcclxuICAgICAgbGFzdE1vbnRoU3RhcnQuc2V0TW9udGgobGFzdE1vbnRoU3RhcnQuZ2V0TW9udGgoKSAtIDEpO1xyXG4gICAgICBjb25zdCBsYXN0TW9udGhFbmQgPSBuZXcgRGF0ZSh0b2RheSk7XHJcbiAgICAgIGxhc3RNb250aEVuZC5zZXREYXRlKGxhc3RNb250aEVuZC5nZXREYXRlKCkgLSAxKTtcclxuICAgICAgZGF0ZUNvbmRpdGlvbiA9IGBEQVRFKG9yZGVyX2RhdGUpIEJFVFdFRU4gJyR7bGFzdE1vbnRoU3RhcnQudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdfScgQU5EICcke2xhc3RNb250aEVuZC50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF19J2A7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgZGVmYXVsdDpcclxuICAgICAgZGF0ZUNvbmRpdGlvbiA9ICdEQVRFKG9yZGVyX2RhdGUpID0gQ1VSREFURSgpJztcclxuICB9XHJcblxyXG4gIHRyeSB7XHJcbiAgICAvLyBUb3RhbCBTYWxlcyAoYWx3YXlzIG9ubHkgXCJEZWxpdmVyZWRcIiBzdGF0dXMpXHJcbiAgICBjb25zdCBbc2FsZXNSZXN1bHRdID0gYXdhaXQgZGIucXVlcnkoYFxyXG4gICAgICBTRUxFQ1QgQ09BTEVTQ0UoU1VNKHRvdGFsKSwgMCkgYXMgcGVyaW9kU2FsZXNcclxuICAgICAgRlJPTSBvcmRlcnNcclxuICAgICAgV0hFUkUgJHtkYXRlQ29uZGl0aW9ufSBBTkQgc3RhdHVzID0gJ0RlbGl2ZXJlZCdcclxuICAgIGApO1xyXG5cclxuICAgIC8vIFRvdGFsIE9yZGVyc1xyXG4gICAgbGV0IG9yZGVyc1N0YXR1c0NvbmRpdGlvbiA9IFwic3RhdHVzID0gJ0RlbGl2ZXJlZCdcIjtcclxuICAgIGlmICh0aW1lRnJhbWUgPT09ICdsYXN0V2VlaycgfHwgdGltZUZyYW1lID09PSAnbGFzdE1vbnRoJykge1xyXG4gICAgICBvcmRlcnNTdGF0dXNDb25kaXRpb24gPSBcInN0YXR1cyBJTiAoJ09yZGVyIFBsYWNlZCcsICdQcm9jZXNzZWQnLCAnU2hpcHBlZCcsICdEZWxpdmVyZWQnLCAnQ2FuY2VsbGVkJylcIjtcclxuICAgIH1cclxuICAgIGNvbnN0IFtvcmRlcnNSZXN1bHRdID0gYXdhaXQgZGIucXVlcnkoYFxyXG4gICAgICBTRUxFQ1QgQ09VTlQoKikgYXMgdG90YWxPcmRlcnNcclxuICAgICAgRlJPTSBvcmRlcnNcclxuICAgICAgV0hFUkUgJHtkYXRlQ29uZGl0aW9ufSBBTkQgJHtvcmRlcnNTdGF0dXNDb25kaXRpb259XHJcbiAgICBgKTtcclxuXHJcbiAgICAvLyBUb3RhbCBDdXN0b21lcnMgKGFsd2F5cyBhbGwgc3RhdHVzZXMpXHJcbiAgICBjb25zdCBbY3VzdG9tZXJzUmVzdWx0XSA9IGF3YWl0IGRiLnF1ZXJ5KGBcclxuICAgICAgU0VMRUNUIENPVU5UKERJU1RJTkNUIHVzZXJfaWQpIGFzIHRvdGFsQ3VzdG9tZXJzXHJcbiAgICAgIEZST00gb3JkZXJzXHJcbiAgICAgIFdIRVJFICR7ZGF0ZUNvbmRpdGlvbn1cclxuICAgIGApO1xyXG5cclxuICAgIGNvbnN0IHJlc3VsdCA9IHtcclxuICAgICAgcGVyaW9kU2FsZXM6IE51bWJlcihzYWxlc1Jlc3VsdFswXS5wZXJpb2RTYWxlcyksXHJcbiAgICAgIHRvdGFsT3JkZXJzOiBvcmRlcnNSZXN1bHRbMF0udG90YWxPcmRlcnMsXHJcbiAgICAgIHRvdGFsQ3VzdG9tZXJzOiBjdXN0b21lcnNSZXN1bHRbMF0udG90YWxDdXN0b21lcnNcclxuICAgIH07XHJcblxyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24ocmVzdWx0KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgc2FsZXMgZGF0YTonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRXJyb3IgZmV0Y2hpbmcgc2FsZXMgZGF0YScgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVHZXRUb3RhbFByb2R1Y3RzKHJlcSwgcmVzKSB7XHJcbiAgY29uc3QgW3Jlc3VsdF0gPSBhd2FpdCBkYi5xdWVyeSgnU0VMRUNUIENPVU5UKCopIGFzIHRvdGFsUHJvZHVjdHMgRlJPTSBwcm9kdWN0cycpO1xyXG4gIHJlcy5zdGF0dXMoMjAwKS5qc29uKHJlc3VsdFswXSk7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUdldFRvcFByb2R1Y3RzKHJlcSwgcmVzKSB7XHJcbiAgY29uc3QgW3Jlc3VsdF0gPSBhd2FpdCBkYi5xdWVyeShgXHJcbiAgICBTRUxFQ1QgXHJcbiAgICAgIHAuaWQsXHJcbiAgICAgIHAubmFtZSxcclxuICAgICAgcC5pbWFnZV91cmwsXHJcbiAgICAgIENPQUxFU0NFKEFWRyhwci5yYXRpbmcpLCAwKSBhcyBhdmdfcmF0aW5nLFxyXG4gICAgICBDT0FMRVNDRShTVU0ob3AucXVhbnRpdHkpLCAwKSBhcyBzb2xkXHJcbiAgICBGUk9NIHByb2R1Y3RzIHBcclxuICAgIExFRlQgSk9JTiBvcmRlcmVkX3Byb2R1Y3RzIG9wIE9OIHAuaWQgPSBvcC5wcm9kdWN0X2lkXHJcbiAgICBMRUZUIEpPSU4gcHJvZHVjdF9yYXRpbmdzIHByIE9OIHAuaWQgPSBwci5wcm9kdWN0X2lkXHJcbiAgICBHUk9VUCBCWSBwLmlkXHJcbiAgICBPUkRFUiBCWSBzb2xkIERFU0MsIGF2Z19yYXRpbmcgREVTQ1xyXG4gICAgTElNSVQgNVxyXG4gIGApO1xyXG4gIFxyXG4gIGNvbnN0IGZvcm1hdHRlZFJlc3VsdCA9IHJlc3VsdC5tYXAocHJvZHVjdCA9PiAoe1xyXG4gICAgLi4ucHJvZHVjdCxcclxuICAgIGF2Z19yYXRpbmc6IE51bWJlcihwcm9kdWN0LmF2Z19yYXRpbmcpLnRvRml4ZWQoMSlcclxuICB9KSk7XHJcbiAgXHJcbiAgcmVzLnN0YXR1cygyMDApLmpzb24oZm9ybWF0dGVkUmVzdWx0KTtcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlR2V0UmF0ZWRQcm9kdWN0c0NvdW50KHJlcSwgcmVzKSB7XHJcbiAgY29uc3QgeyB0aW1lRnJhbWUgfSA9IHJlcS5xdWVyeTtcclxuICBsZXQgZGF0ZUNvbmRpdGlvbjtcclxuXHJcbiAgc3dpdGNoICh0aW1lRnJhbWUpIHtcclxuICAgIGNhc2UgJ3RvZGF5JzpcclxuICAgICAgZGF0ZUNvbmRpdGlvbiA9ICdEQVRFKGNyZWF0ZWRfYXQpID0gQ1VSREFURSgpJztcclxuICAgICAgYnJlYWs7XHJcbiAgICBjYXNlICd5ZXN0ZXJkYXknOlxyXG4gICAgICBkYXRlQ29uZGl0aW9uID0gJ0RBVEUoY3JlYXRlZF9hdCkgPSBEQVRFX1NVQihDVVJEQVRFKCksIElOVEVSVkFMIDEgREFZKSc7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSAnbGFzdFdlZWsnOlxyXG4gICAgICBkYXRlQ29uZGl0aW9uID0gJ0RBVEUoY3JlYXRlZF9hdCkgQkVUV0VFTiBEQVRFX1NVQihDVVJEQVRFKCksIElOVEVSVkFMIDEgV0VFSykgQU5EIENVUkRBVEUoKSc7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSAnbGFzdE1vbnRoJzpcclxuICAgICAgZGF0ZUNvbmRpdGlvbiA9ICdEQVRFKGNyZWF0ZWRfYXQpIEJFVFdFRU4gREFURV9TVUIoQ1VSREFURSgpLCBJTlRFUlZBTCAxIE1PTlRIKSBBTkQgQ1VSREFURSgpJztcclxuICAgICAgYnJlYWs7XHJcbiAgICBkZWZhdWx0OlxyXG4gICAgICBkYXRlQ29uZGl0aW9uID0gJ0RBVEUoY3JlYXRlZF9hdCkgPSBDVVJEQVRFKCknO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgW3Jlc3VsdF0gPSBhd2FpdCBkYi5xdWVyeShgXHJcbiAgICBTRUxFQ1QgQ09VTlQoRElTVElOQ1QgcHJvZHVjdF9pZCkgYXMgcmF0ZWRQcm9kdWN0c0NvdW50XHJcbiAgICBGUk9NIHByb2R1Y3RfcmF0aW5nc1xyXG4gICAgV0hFUkUgJHtkYXRlQ29uZGl0aW9ufVxyXG4gIGApO1xyXG5cclxuICByZXMuc3RhdHVzKDIwMCkuanNvbihyZXN1bHRbMF0pO1xyXG59XHJcblxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlR2V0UHJvZHVjdHMocmVxLCByZXMpIHtcclxuICBjb25zdCB7IHBhZ2UgPSAxLCBsaW1pdCA9IDEwIH0gPSByZXEucXVlcnk7XHJcbiAgY29uc3Qgb2Zmc2V0ID0gKHBhZ2UgLSAxKSAqIGxpbWl0O1xyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgW2NvdW50UmVzdWx0XSA9IGF3YWl0IGRiLnF1ZXJ5KCdTRUxFQ1QgQ09VTlQoKikgYXMgdG90YWwgRlJPTSBwcm9kdWN0cyBXSEVSRSBkZWxldGVkID0gRkFMU0UnKTtcclxuICAgIGNvbnN0IHRvdGFsSXRlbXMgPSBjb3VudFJlc3VsdFswXS50b3RhbDtcclxuICAgIGNvbnN0IHRvdGFsUGFnZXMgPSBNYXRoLmNlaWwodG90YWxJdGVtcyAvIGxpbWl0KTtcclxuXHJcbiAgICBjb25zdCBbcHJvZHVjdHNdID0gYXdhaXQgZGIucXVlcnkoJ1NFTEVDVCAqIEZST00gcHJvZHVjdHMgV0hFUkUgZGVsZXRlZCA9IEZBTFNFIExJTUlUID8gT0ZGU0VUID8nLCBbcGFyc2VJbnQobGltaXQpLCBvZmZzZXRdKTtcclxuXHJcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7XHJcbiAgICAgIHByb2R1Y3RzLFxyXG4gICAgICBjdXJyZW50UGFnZTogcGFyc2VJbnQocGFnZSksXHJcbiAgICAgIHRvdGFsUGFnZXMsXHJcbiAgICAgIHRvdGFsSXRlbXNcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBwcm9kdWN0czonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRXJyb3IgZmV0Y2hpbmcgcHJvZHVjdHMnIH0pO1xyXG4gIH1cclxufVxyXG5cclxuXHJcblxyXG5cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUdldFRvdGFsU3RvY2socmVxLCByZXMpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgW3Jlc3VsdF0gPSBhd2FpdCBkYi5xdWVyeSgnU0VMRUNUIFNVTShzdG9ja19xdWFudGl0eSkgYXMgdG90YWxTdG9jayBGUk9NIHByb2R1Y3RzJyk7XHJcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IHRvdGFsU3RvY2s6IHJlc3VsdFswXS50b3RhbFN0b2NrIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyB0b3RhbCBzdG9jazonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRXJyb3IgZmV0Y2hpbmcgdG90YWwgc3RvY2snIH0pO1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlQWRkUHJvZHVjdChyZXEsIHJlcykge1xyXG4gIGNvbnN0IHsgbmFtZSwgZGVzY3JpcHRpb24sIHByaWNlLCBpbWFnZV91cmwsIHN0b2NrX3F1YW50aXR5LCBjYXRlZ29yeSwgc3VwcGxpZXJfaWQgfSA9IHJlcS5ib2R5O1xyXG4gIGNvbnN0IG9yZGVyX2lkID0gZ2VuZXJhdGVPcmRlcklkKCk7XHJcbiAgY29uc3Qgc3FsID0gXCJJTlNFUlQgSU5UTyBwcm9kdWN0cyAobmFtZSwgZGVzY3JpcHRpb24sIHByaWNlLCBpbWFnZV91cmwsIHN0b2NrX3F1YW50aXR5LCBjYXRlZ29yeSwgc3VwcGxpZXJfaWQsIG9yZGVyX2lkKSBWQUxVRVMgKD8sID8sID8sID8sID8sID8sID8sID8pXCI7XHJcbiAgXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IFtyZXN1bHRdID0gYXdhaXQgZGIucXVlcnkoc3FsLCBbbmFtZSwgZGVzY3JpcHRpb24sIHByaWNlLCBpbWFnZV91cmwsIHN0b2NrX3F1YW50aXR5LCBjYXRlZ29yeSwgc3VwcGxpZXJfaWQsIG9yZGVyX2lkXSk7XHJcbiAgICByZXMuc3RhdHVzKDIwMSkuanNvbih7IG1lc3NhZ2U6ICdQcm9kdWN0IGFkZGVkIHN1Y2Nlc3NmdWxseScsIGlkOiByZXN1bHQuaW5zZXJ0SWQsIG9yZGVyX2lkOiBvcmRlcl9pZCB9KTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgYWRkaW5nIHByb2R1Y3Q6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0Vycm9yIGFkZGluZyBwcm9kdWN0JyB9KTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdlbmVyYXRlT3JkZXJJZCgpIHtcclxuICByZXR1cm4gJ09SRC0nICsgTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpLnRvVXBwZXJDYXNlKCk7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZVVwZGF0ZVByb2R1Y3QocmVxLCByZXMsIGlkKSB7XHJcbiAgY29uc3QgeyBuYW1lLCBkZXNjcmlwdGlvbiwgcHJpY2UsIGltYWdlX3VybCwgc3RvY2tfcXVhbnRpdHksIGNhdGVnb3J5LCBzdXBwbGllcl9pZCB9ID0gcmVxLmJvZHk7XHJcbiAgY29uc3Qgc3FsID0gXCJVUERBVEUgcHJvZHVjdHMgU0VUIG5hbWU9PywgZGVzY3JpcHRpb249PywgcHJpY2U9PywgaW1hZ2VfdXJsPT8sIHN0b2NrX3F1YW50aXR5PT8sIGNhdGVnb3J5PT8sIHN1cHBsaWVyX2lkPT8gV0hFUkUgaWQ9P1wiO1xyXG4gIFxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbcmVzdWx0XSA9IGF3YWl0IGRiLnF1ZXJ5KHNxbCwgW25hbWUsIGRlc2NyaXB0aW9uLCBwcmljZSwgaW1hZ2VfdXJsLCBzdG9ja19xdWFudGl0eSwgY2F0ZWdvcnksIHN1cHBsaWVyX2lkLCBpZF0pO1xyXG4gICAgaWYgKHJlc3VsdC5hZmZlY3RlZFJvd3MgPT09IDApIHtcclxuICAgICAgcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvcjogJ1Byb2R1Y3Qgbm90IGZvdW5kJyB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbWVzc2FnZTogJ1Byb2R1Y3QgdXBkYXRlZCBzdWNjZXNzZnVsbHknIH0pO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBwcm9kdWN0OicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdFcnJvciB1cGRhdGluZyBwcm9kdWN0JyB9KTtcclxuICB9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZURlbGV0ZVByb2R1Y3QocmVxLCByZXMsIGlkKSB7XHJcbiAgY29uc3Qgc3FsID0gXCJVUERBVEUgcHJvZHVjdHMgU0VUIGRlbGV0ZWQgPSBUUlVFIFdIRVJFIGlkID0gP1wiO1xyXG4gIFxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbcmVzdWx0XSA9IGF3YWl0IGRiLnF1ZXJ5KHNxbCwgW2lkXSk7XHJcbiAgICBpZiAocmVzdWx0LmFmZmVjdGVkUm93cyA9PT0gMCkge1xyXG4gICAgICByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnUHJvZHVjdCBub3QgZm91bmQnIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBtZXNzYWdlOiAnUHJvZHVjdCBtYXJrZWQgYXMgZGVsZXRlZCBzdWNjZXNzZnVsbHknIH0pO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBtYXJraW5nIHByb2R1Y3QgYXMgZGVsZXRlZDonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRXJyb3IgbWFya2luZyBwcm9kdWN0IGFzIGRlbGV0ZWQnIH0pO1xyXG4gIH1cclxufVxyXG5cclxuXHJcblxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVHZXRTYWxlc1JlcG9ydChyZXEsIHJlcykge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbcmVzdWx0XSA9IGF3YWl0IGRiLnF1ZXJ5KCdTRUxFQ1QgKiBGUk9NIHVzZXJfbG9naW4nKTtcclxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHJlc3VsdCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHNhbGVzIHJlcG9ydDonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgZmV0Y2hpbmcgc2FsZXMgcmVwb3J0IGRhdGEnIH0pO1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlVXBkYXRlT3JkZXJTdGF0dXMocmVxLCByZXMsIGlkKSB7XHJcbiAgY29uc3QgeyBzdGF0dXMgfSA9IHJlcS5ib2R5O1xyXG4gIGNvbnNvbGUubG9nKCdVcGRhdGluZyBvcmRlciBzdGF0dXM6JywgaWQsIHN0YXR1cyk7XHJcblxyXG4gIGNvbnN0IHNxbCA9IFwiVVBEQVRFIG9yZGVycyBTRVQgc3RhdHVzID0gPyBXSEVSRSBpZCA9ID9cIjtcclxuICB0cnkge1xyXG4gICAgY29uc3QgW3Jlc3VsdF0gPSBhd2FpdCBkYi5xdWVyeShzcWwsIFtzdGF0dXMsIGlkXSk7XHJcbiAgICBpZiAocmVzdWx0LmFmZmVjdGVkUm93cyA9PT0gMCkge1xyXG4gICAgICByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnT3JkZXIgbm90IGZvdW5kJyB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbWVzc2FnZTogJ09yZGVyIHN0YXR1cyB1cGRhdGVkIHN1Y2Nlc3NmdWxseScsIHN0YXR1czogc3RhdHVzIH0pO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBvcmRlciBzdGF0dXM6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0Vycm9yIHVwZGF0aW5nIG9yZGVyIHN0YXR1cycgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVDYW5jZWxPcmRlcihyZXEsIHJlcywgaWQpIHtcclxuICBjb25zdCBzcWwgPSBcIlVQREFURSBvcmRlcnMgU0VUIHN0YXR1cyA9ICdDYW5jZWxsZWQnIFdIRVJFIGlkID0gP1wiO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbcmVzdWx0XSA9IGF3YWl0IGRiLnF1ZXJ5KHNxbCwgW2lkXSk7XHJcbiAgICBpZiAocmVzdWx0LmFmZmVjdGVkUm93cyA9PT0gMCkge1xyXG4gICAgICByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnT3JkZXIgbm90IGZvdW5kJyB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbWVzc2FnZTogJ09yZGVyIGNhbmNlbGxlZCBzdWNjZXNzZnVsbHknIH0pO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjYW5jZWxsaW5nIG9yZGVyOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdFcnJvciBjYW5jZWxsaW5nIG9yZGVyJyB9KTtcclxuICB9XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlVXBkYXRlT3JkZXIocmVxLCByZXMsIGlkKSB7XHJcbiAgY29uc3QgeyBvcmRlcl9kYXRlIH0gPSByZXEuYm9keTtcclxuICBjb25zdCBzcWwgPSBcIlVQREFURSBvcmRlcnMgU0VUIG9yZGVyX2RhdGUgPSA/IFdIRVJFIGlkID0gP1wiO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbcmVzdWx0XSA9IGF3YWl0IGRiLnF1ZXJ5KHNxbCwgW29yZGVyX2RhdGUsIGlkXSk7XHJcbiAgICBpZiAocmVzdWx0LmFmZmVjdGVkUm93cyA9PT0gMCkge1xyXG4gICAgICByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnT3JkZXIgbm90IGZvdW5kJyB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbWVzc2FnZTogJ09yZGVyIGRhdGUgdXBkYXRlZCBzdWNjZXNzZnVsbHknIH0pO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyBvcmRlciBkYXRlOicsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdFcnJvciB1cGRhdGluZyBvcmRlciBkYXRlJyB9KTtcclxuICB9XHJcbn1cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlUmVtb3ZlT3JkZXJGcm9tU2FsZXNSZXBvcnQocmVxLCByZXMpIHtcclxuICBjb25zdCB7IGlkIH0gPSByZXEucXVlcnk7XHJcbiAgY29uc3Qgc3FsID0gXCJVUERBVEUgb3JkZXJzIFNFVCBpbl9zYWxlc19yZXBvcnQgPSAwIFdIRVJFIGlkID0gP1wiO1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbcmVzdWx0XSA9IGF3YWl0IGRiLnF1ZXJ5KHNxbCwgW2lkXSk7XHJcbiAgICBpZiAocmVzdWx0LmFmZmVjdGVkUm93cyA9PT0gMCkge1xyXG4gICAgICByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnT3JkZXIgbm90IGZvdW5kJyB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbWVzc2FnZTogJ09yZGVyIHJlbW92ZWQgZnJvbSBzYWxlcyByZXBvcnQgc3VjY2Vzc2Z1bGx5JyB9KTtcclxuICAgIH1cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVtb3Zpbmcgb3JkZXIgZnJvbSBzYWxlcyByZXBvcnQ6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0Vycm9yIHJlbW92aW5nIG9yZGVyIGZyb20gc2FsZXMgcmVwb3J0JyB9KTtcclxuICB9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUdldE9yZGVycyhyZXEsIHJlcykge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbcmVzdWx0XSA9IGF3YWl0IGRiLnF1ZXJ5KGBcclxuICAgICAgU0VMRUNUIG8uKiwgXHJcbiAgICAgICAgICAgICBHUk9VUF9DT05DQVQoQ09OQ0FUKG9wLm5hbWUsICcgKCcsIG9wLnF1YW50aXR5LCAnKScpIFNFUEFSQVRPUiAnLCAnKSBBUyBvcmRlcmVkX3Byb2R1Y3RzXHJcbiAgICAgIEZST00gb3JkZXJzIG9cclxuICAgICAgTEVGVCBKT0lOIG9yZGVyZWRfcHJvZHVjdHMgb3AgT04gby5pZCA9IG9wLm9yZGVyX2lkXHJcbiAgICAgIFdIRVJFIG8uaW5fc2FsZXNfcmVwb3J0ID0gMVxyXG4gICAgICBHUk9VUCBCWSBvLmlkXHJcbiAgICBgKTtcclxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHJlc3VsdCk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIG9yZGVyczonLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgZmV0Y2hpbmcgb3JkZXJzJyB9KTtcclxuICB9XHJcbn1cclxuXHJcblxyXG5leHBvcnQgeyBoYW5kbGVVcGRhdGVBZG1pbkRhdGEgfTsiXSwibmFtZXMiOlsibXlzcWwiLCJwYXJzZSIsInNpZ24iLCJ2ZXJpZnkiLCJxdWVyeSIsImRiIiwiY3JlYXRlUG9vbCIsImhvc3QiLCJwcm9jZXNzIiwiZW52IiwiTVlTUUxfSE9TVCIsInBvcnQiLCJNWVNRTF9QT1JUIiwidXNlciIsIk1ZU1FMX1VTRVIiLCJwYXNzd29yZCIsIk1ZU1FMX1BBU1NXT1JEIiwiZGF0YWJhc2UiLCJNWVNRTF9EQVRBQkFTRSIsIndhaXRGb3JDb25uZWN0aW9ucyIsImNvbm5lY3Rpb25MaW1pdCIsInF1ZXVlTGltaXQiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwibWV0aG9kIiwicGF0aG5hbWUiLCJ1cmwiLCJjb25zb2xlIiwibG9nIiwic3RhdHVzIiwianNvbiIsIm1lc3NhZ2UiLCJyZXN1bHRzIiwibGVuZ3RoIiwiZnVsbE5hbWUiLCJmdWxsX25hbWUiLCJlcnJvciIsImF1dGhIZWFkZXIiLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsImlzQXV0aGVudGljYXRlZCIsInVzZXJuYW1lUGFzc3dvcmRWZXJpZmllZCIsInRva2VuIiwic3BsaXQiLCJkZWNvZGVkIiwiSldUX1NFQ1JFVCIsIm5vdyIsIk1hdGgiLCJmbG9vciIsIkRhdGUiLCJleHAiLCJleHBpcmVzSW4iLCJoYW5kbGVHZXRQcm9kdWN0cyIsImhhbmRsZUdldFRvdGFsU3RvY2siLCJoYW5kbGVHZXRTYWxlc1JlcG9ydCIsImhhbmRsZUdldFNhbGVzRGF0YSIsImhhbmRsZUdldFRvdGFsUHJvZHVjdHMiLCJoYW5kbGVHZXRUb3BQcm9kdWN0cyIsImhhbmRsZUdldFJhdGVkUHJvZHVjdHNDb3VudCIsImhhbmRsZUxvZ291dCIsImhhbmRsZUdldE9yZGVycyIsImhhbmRsZUdldEFkbWluRGF0YSIsImhhbmRsZUdldFNlc3Npb25IaXN0b3J5IiwiaGFuZGxlU2lnbkluIiwiaGFuZGxlVmFsaWRhdGVQaW4iLCJoYW5kbGVBZGRQcm9kdWN0Iiwic3RhcnRzV2l0aCIsImlkIiwicG9wIiwiaGFuZGxlVXBkYXRlUHJvZHVjdCIsInBhcnRzIiwiaGFuZGxlVXBkYXRlT3JkZXJTdGF0dXMiLCJoYW5kbGVDYW5jZWxPcmRlciIsImhhbmRsZVVwZGF0ZU9yZGVyIiwiaGFuZGxlVXBkYXRlQWRtaW5EYXRhIiwiaGFuZGxlRGVsZXRlUHJvZHVjdCIsImVuZHNXaXRoIiwiaGFuZGxlUmVtb3ZlT3JkZXJGcm9tU2FsZXNSZXBvcnQiLCJzZXRIZWFkZXIiLCJlbmQiLCJ1c2VybmFtZSIsImJvZHkiLCJwYXNzd29yZE1hdGNoIiwidXNlcklkIiwic3VjY2VzcyIsInBpbiIsInN0b3JlZFBpbiIsIlN0cmluZyIsImFkbWluRGF0YSIsInJlcGVhdCIsInJvbGUiLCJzcWwiLCJwYXJhbXMiLCJwdXNoIiwicmVzdWx0IiwiYWZmZWN0ZWRSb3dzIiwidGltZUZyYW1lIiwiZGF0ZUNvbmRpdGlvbiIsInN0YXR1c0NvbmRpdGlvbiIsInRvZGF5Iiwic2V0SG91cnMiLCJsYXN0V2Vla1N0YXJ0Iiwic2V0RGF0ZSIsImdldERhdGUiLCJsYXN0V2Vla0VuZCIsInRvSVNPU3RyaW5nIiwibGFzdE1vbnRoU3RhcnQiLCJzZXRNb250aCIsImdldE1vbnRoIiwibGFzdE1vbnRoRW5kIiwic2FsZXNSZXN1bHQiLCJvcmRlcnNTdGF0dXNDb25kaXRpb24iLCJvcmRlcnNSZXN1bHQiLCJjdXN0b21lcnNSZXN1bHQiLCJwZXJpb2RTYWxlcyIsIk51bWJlciIsInRvdGFsT3JkZXJzIiwidG90YWxDdXN0b21lcnMiLCJmb3JtYXR0ZWRSZXN1bHQiLCJtYXAiLCJwcm9kdWN0IiwiYXZnX3JhdGluZyIsInRvRml4ZWQiLCJwYWdlIiwibGltaXQiLCJvZmZzZXQiLCJjb3VudFJlc3VsdCIsInRvdGFsSXRlbXMiLCJ0b3RhbCIsInRvdGFsUGFnZXMiLCJjZWlsIiwicHJvZHVjdHMiLCJwYXJzZUludCIsImN1cnJlbnRQYWdlIiwidG90YWxTdG9jayIsIm5hbWUiLCJkZXNjcmlwdGlvbiIsInByaWNlIiwiaW1hZ2VfdXJsIiwic3RvY2tfcXVhbnRpdHkiLCJjYXRlZ29yeSIsInN1cHBsaWVyX2lkIiwib3JkZXJfaWQiLCJnZW5lcmF0ZU9yZGVySWQiLCJpbnNlcnRJZCIsInJhbmRvbSIsInRvU3RyaW5nIiwic3Vic3RyIiwidG9VcHBlckNhc2UiLCJvcmRlcl9kYXRlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/pages/api/[...nextapi].js\n");

/***/ }),

/***/ "(api)/./src/utils/db.js":
/*!*************************!*\
  !*** ./src/utils/db.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   query: () => (/* binding */ query)\n/* harmony export */ });\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mysql2/promise */ \"mysql2/promise\");\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mysql2_promise__WEBPACK_IMPORTED_MODULE_0__);\n\nconst pool = mysql2_promise__WEBPACK_IMPORTED_MODULE_0___default().createPool({\n    host: process.env.MYSQL_HOST,\n    port: parseInt(process.env.MYSQL_PORT),\n    database: process.env.MYSQL_DATABASE,\n    user: process.env.MYSQL_USER,\n    password: process.env.MYSQL_PASSWORD,\n    connectionLimit: 10,\n    waitForConnections: true,\n    queueLimit: 0\n});\nasync function query(sql, values) {\n    try {\n        const [results] = await pool.query(sql, values);\n        return results;\n    } catch (error) {\n        console.error(\"Database query error:\", error);\n        throw error;\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (pool);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvdXRpbHMvZGIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFtQztBQUVuQyxNQUFNQyxPQUFPRCxnRUFBZ0IsQ0FBQztJQUM1QkcsTUFBTUMsUUFBUUMsR0FBRyxDQUFDQyxVQUFVO0lBQzVCQyxNQUFNQyxTQUFTSixRQUFRQyxHQUFHLENBQUNJLFVBQVU7SUFDckNDLFVBQVVOLFFBQVFDLEdBQUcsQ0FBQ00sY0FBYztJQUNwQ0MsTUFBTVIsUUFBUUMsR0FBRyxDQUFDUSxVQUFVO0lBQzVCQyxVQUFVVixRQUFRQyxHQUFHLENBQUNVLGNBQWM7SUFDcENDLGlCQUFpQjtJQUNqQkMsb0JBQW9CO0lBQ3BCQyxZQUFZO0FBQ2Q7QUFFTyxlQUFlQyxNQUFNQyxHQUFHLEVBQUVDLE1BQU07SUFDckMsSUFBSTtRQUNGLE1BQU0sQ0FBQ0MsUUFBUSxHQUFHLE1BQU1yQixLQUFLa0IsS0FBSyxDQUFDQyxLQUFLQztRQUN4QyxPQUFPQztJQUNULEVBQUUsT0FBT0MsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMseUJBQXlCQTtRQUN2QyxNQUFNQTtJQUNSO0FBQ0Y7QUFFQSxpRUFBZXRCLElBQUlBLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hZG1pbnBhbmVsLy4vc3JjL3V0aWxzL2RiLmpzP2QzODQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG15c3FsIGZyb20gJ215c3FsMi9wcm9taXNlJztcclxuXHJcbmNvbnN0IHBvb2wgPSBteXNxbC5jcmVhdGVQb29sKHtcclxuICBob3N0OiBwcm9jZXNzLmVudi5NWVNRTF9IT1NULFxyXG4gIHBvcnQ6IHBhcnNlSW50KHByb2Nlc3MuZW52Lk1ZU1FMX1BPUlQpLFxyXG4gIGRhdGFiYXNlOiBwcm9jZXNzLmVudi5NWVNRTF9EQVRBQkFTRSxcclxuICB1c2VyOiBwcm9jZXNzLmVudi5NWVNRTF9VU0VSLFxyXG4gIHBhc3N3b3JkOiBwcm9jZXNzLmVudi5NWVNRTF9QQVNTV09SRCxcclxuICBjb25uZWN0aW9uTGltaXQ6IDEwLFxyXG4gIHdhaXRGb3JDb25uZWN0aW9uczogdHJ1ZSxcclxuICBxdWV1ZUxpbWl0OiAwXHJcbn0pO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHF1ZXJ5KHNxbCwgdmFsdWVzKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IFtyZXN1bHRzXSA9IGF3YWl0IHBvb2wucXVlcnkoc3FsLCB2YWx1ZXMpO1xyXG4gICAgcmV0dXJuIHJlc3VsdHM7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0RhdGFiYXNlIHF1ZXJ5IGVycm9yOicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgcG9vbDsiXSwibmFtZXMiOlsibXlzcWwiLCJwb29sIiwiY3JlYXRlUG9vbCIsImhvc3QiLCJwcm9jZXNzIiwiZW52IiwiTVlTUUxfSE9TVCIsInBvcnQiLCJwYXJzZUludCIsIk1ZU1FMX1BPUlQiLCJkYXRhYmFzZSIsIk1ZU1FMX0RBVEFCQVNFIiwidXNlciIsIk1ZU1FMX1VTRVIiLCJwYXNzd29yZCIsIk1ZU1FMX1BBU1NXT1JEIiwiY29ubmVjdGlvbkxpbWl0Iiwid2FpdEZvckNvbm5lY3Rpb25zIiwicXVldWVMaW1pdCIsInF1ZXJ5Iiwic3FsIiwidmFsdWVzIiwicmVzdWx0cyIsImVycm9yIiwiY29uc29sZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/utils/db.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2F%5B...nextapi%5D&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5C%5B...nextapi%5D.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();